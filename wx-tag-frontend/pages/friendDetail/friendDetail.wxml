<!--pages/friendDetail/friendDetail.wxml-->
<view class="container">
  <view class="page-header">
    <view class="home-button" bindtap="goHome">
      <text class="home-icon">ğŸ </text>
    </view>
    <text class="header-title">å¥½å‹æ ‡ç­¾è¯¦æƒ…</text>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading"></view>
    <text>åŠ è½½ä¸­...</text>
  </view>

  <block wx:else>
    <!-- ç”¨æˆ·èµ„æ–™ -->
    <view class="user-profile">
      <image class="large-avatar" 
             src="{{friendInfo.avatarUrl || '/images/empty.png'}}" 
             mode="aspectFill"
             binderror="onAvatarError"></image>
      <text class="user-name">{{friendInfo.nickname || 'æœªçŸ¥ç”¨æˆ·'}}</text>
      <view class="tag-stats">
        <text class="stats-text">æ€»å…±è·å¾— <text class="tag-count">{{allTags.length || 0}}</text> ç§æ ‡ç­¾</text>
        <text class="stats-text">æ€»å…±æœ‰ <text class="tag-count">{{totalPeople || 0}}</text> äººç»™Taæ‰“æ ‡ç­¾</text>
      </view>
    </view>

    <!-- æˆ‘çš„æ ‡ç­¾ -->
    <view class="section-title">ä½ ç»™Taçš„æ ‡ç­¾</view>
    <view class="tag-list">
      <block wx:if="{{myTags && myTags.length > 0}}">
        <view class="tag-item-bubble" wx:for="{{myTags}}" wx:key="{{item.id || item.tagName || index}}">
          <text class="bubble-name">{{item.tagName || item}}</text>
        </view>
      </block>
      <view class="empty-tags" wx:else>
        <text>ä½ è¿˜æ²¡æœ‰ç»™Taè´´è¿‡æ ‡ç­¾</text>
      </view>
    </view>

    <!-- æ ‡ç­¾æ€»è§ˆ -->
    <view class="section-title">Taçš„æ ‡ç­¾æ€»è§ˆ</view>
    <view class="tag-list">
      <block wx:if="{{allTags && allTags.length > 0}}">
        <view class="tag-item-bubble" wx:for="{{allTags}}" wx:key="index">
          <text class="bubble-name">{{item.tagName}}</text>
          <text class="bubble-count">{{item.tagCount}}</text>
        </view>
      </block>
      <view class="empty-tags" wx:else>
        <text>Taè¿˜æ²¡æœ‰æ”¶åˆ°ä»»ä½•æ ‡ç­¾</text>
      </view>
    </view>

    <!-- AIåˆ†æ -->
    <view class="section-title">AIåˆ†æè¯„è¯­</view>
    <view class="comment-box">
      <text class="comment-text">{{aiComment || 'æš‚æ— AIåˆ†æè¯„è¯­'}}</text>
    </view>
  </block>
</view>