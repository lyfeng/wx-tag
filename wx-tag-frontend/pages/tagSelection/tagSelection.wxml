<!--tagSelection.wxml-->
<view class="container">
  <!-- æ ‡é¢˜ -->
  <view class="header">
    <view class="home-button" bindtap="goHome">
      <text class="home-icon">ğŸ </text>
    </view>
    <view class="header-content">
      <text class="title">è¯·é€‰æ‹©æ ‡ç­¾ï¼ˆæœ€å¤š{{maxTags}}ä¸ªï¼‰</text>
      <text class="selected-count">å·²é€‰æ‹© {{selectedTags.length}}/{{maxTags}}</text>
    </view>
    <view class="share-button" bindtap="onCustomShare">
      <text class="share-icon">ğŸ“¤</text>
    </view>
  </view>

  <!-- è¢«è¯„ä»·ç”¨æˆ·ä¿¡æ¯ -->
  <view class="target-user-info" wx:if="{{targetUserInfo}}">
    <image class="target-avatar" src="{{targetUserInfo.avatarUrl}}" mode="aspectFill"></image>
    <text class="target-name">æ­£åœ¨ç»™ {{targetUserInfo.nickname}} æ‰“æ ‡ç­¾</text>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading"></view>
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- æ ‡ç­¾å†…å®¹ -->
  <view class="content" wx:else>
    <!-- ç±»åˆ«é€‰æ‹©å™¨ -->
    <scroll-view class="category-scroll" scroll-x>
      <view class="category-list">
        <view 
          class="category-item {{activeCategory === category ? 'active' : ''}}" 
          wx:for="{{categories}}" 
          wx:key="*this"
          wx:for-item="category"
          bindtap="switchCategory"
          data-category="{{category}}">
          {{category}}
        </view>
      </view>
    </scroll-view>

    <!-- æ ‡ç­¾åˆ—è¡¨ -->
    <scroll-view class="tag-scroll" scroll-y>
      <view class="tag-list">
        <view 
          class="tag-item {{item.selected ? 'selected' : ''}}" 
          style="{{item.selected ? 'background-color: ' + item.color : ''}}"
          wx:for="{{tags[activeCategory]}}" 
          wx:key="id"
          bindtap="toggleTag"
          data-id="{{item.id}}"
          data-name="{{item.name}}"
          data-category="{{activeCategory}}">
          {{item.name}}
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- åº•éƒ¨æŒ‰é’® -->
  <view class="bottom-button-container">
    <button class="submit-button" bindtap="submitTags" disabled="{{selectedTags.length === 0}}">
      æäº¤æ ‡ç­¾
    </button>
    <button class="share-more-button" open-type="share">
      åˆ†äº«ç»™æ›´å¤šæœ‹å‹
    </button>
  </view>
</view> 